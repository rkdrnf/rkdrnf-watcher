!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define("rkdrnfWatcher",[],e):"object"==typeof exports?exports.rkdrnfWatcher=e():t.rkdrnfWatcher=e()}("undefined"!=typeof self?self:this,function(){return function(t){var e={};function r(i){if(e[i])return e[i].exports;var s=e[i]={i:i,l:!1,exports:{}};return t[i].call(s.exports,s,s.exports,r),s.l=!0,s.exports}return r.m=t,r.c=e,r.d=function(t,e,i){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(r.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var s in t)r.d(i,s,function(e){return t[e]}.bind(null,s));return i},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="",r(r.s=0)}([function(t,e,r){const i=r(1);t.exports={Component:i}},function(t,e){t.exports=class{constructor(){this._proxies=new Map,this._watched=new Map,this._dirtyProps=new Set,this._callbacks=new Map}step(){this._detectChanges()}watch(t,e){const r=this[t];this._watched.has(t)||(this._callbacks.set(t,e),this._watchForDirectAssignment(t),this._watchForObjectManipulation(t,r),this._watched.set(t,{dirty:!1,val:r}))}_watchForDirectAssignment(t){Object.defineProperty(this,t,{get:()=>this._proxies.get(t),set:e=>{this._updateProp(t,e),this._watchForObjectManipulation(t,e)}})}_watchForObjectManipulation(t,e){Array.isArray(e)?this._setArrayListener(t,e):this._isNotNullObject(e)?this._setObjectListener(t,e):this._proxies.set(t,e)}_setArrayListener(t,e){this._proxies.set(t,new Proxy(e,{set:(e,r,i)=>Number.isInteger(Number(r))?(this._updateProp(t,e),e[r]=i,!0):(e[r]=i,!0)}))}_setObjectListener(t,e){this._proxies.set(t,new Proxy(e,{set:(e,r,i)=>(this._updateProp(t,e),e[r]=i,!0)}))}_updateProp(t,e){if(this._watched.get(t).dirty)return void(this._watched.get(t).val=e);const r=this._watched.get(t).val;this._watched.set(t,{old:this._copy(r),dirty:!0,val:e}),this._dirtyProps.add(t)}_copy(t){return Array.isArray(t)?[...t]:this._isNotNullObject(t)?Object.assign({},t):t}_isNotNullObject(t){return"object"==typeof t&&null!==t}_detectChanges(){for(const t of this._dirtyProps)this._checkEquality(t)||this.dispatch(t),this._watched.get(t).dirty=!1,this._dirtyProps.delete(t)}_checkEquality(t){const e=this._watched.get(t);if(!e.dirty)throw new Error("Only dirty props must be passed");const{old:r,val:i}=e;return!!Object.is(r,i)||typeof r==typeof i&&(Array.isArray(r)?this._compareArray(r,i):!!this._isNotNullObject(r)&&this.compareObject(r,i))}_compareArray(t,e){if(t.length!==e.length)return!1;for(let r in t)if(t[r]!==e[r])return!1;return!0}compareObject(t,e){if(Object.keys(t).length!==Object.keys(e).length)return!1;for(let r in t)if(t[r]!==e[r])return!1;return!0}dispatch(t){const{old:e,val:r}=this._watched.get(t);console.log(`[${t}] changed from: ${JSON.stringify(e)}, to: ${JSON.stringify(r)}`),this._callbacks.get(t)({old:e,val:r})}}}])});